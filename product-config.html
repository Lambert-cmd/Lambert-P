<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>产品配置管理系统</title>
    <link href="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/5.1.3/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.bootcdn.net/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.bootcdn.net/ajax/libs/bootstrap-datetimepicker/4.17.47/css/bootstrap-datetimepicker.min.css" rel="stylesheet">
    <style>
        .card { border-radius: 8px; border: none; transition: transform 0.2s; }
.card:hover { transform: translateY(-2px); }
.card-header { padding: 1rem 1.5rem; }
.form-control { border-radius: 4px; padding: 0.5rem 0.75rem; }
.card-header { background: #f8f9fa; border-bottom: 1px solid #dee2e6; }
.form-label { font-weight: 500; color: #495057; }
        .collapse-icon::after { content: '\f107'; font-family: 'Font Awesome 5 Free'; }
        .collapse-icon.collapsed::after { content: '\f106'; }
        .required::after { content: '*'; color: #dc3545; margin-left: 3px; }
        .triple-textarea { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1rem; }
        .image-preview { margin-top: 1rem; display: flex; gap: 1rem; flex-wrap: wrap; }
        .image-preview img { max-height: 100px; }
    </style>
</head>
<body>
<div class="container py-4">
  <div class="row g-4">
    <div class="col-12 mb-4">
  <h1 class="h3 text-primary mb-0">产品配置管理</h1>
  <hr class="mt-2 mb-4">
</div>
  

    <!-- 基础信息面板 -->
    <div class="col-12 col-md-6 mb-4">
  <div class="card shadow-sm h-100">
        <div class="card-header d-flex justify-content-between align-items-center">
            <h5 class="card-title mb-0 fs-5 text-dark">基础信息配置</h5>

        </div>
</div>
        <div>
            <div class="card-body px-4 py-3">
                <div class="mb-3 row align-items-center g-3">
                    <div class="col-12 col-sm-3">
      <label class="form-label text-muted small mb-1">
<label class="form-label required mb-0">是否预约</label>
                    </div>
<div class="col-12 col-sm-9">
<div class="form-check">
                        <input class="form-check-input" type="radio" name="isReservation" id="reservationYes" checked>
                        <label class="form-check-label" for="reservationYes">是</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="isReservation" id="reservationNo">
                        <label class="form-check-label" for="reservationNo">否</label>
                    </div>
                </div>
                <div class="mb-3">
                    <label class="form-label required">集合地址</label>
                    <input type="text" class="form-control" name="collectionAddress" placeholder="请输入集合地址">
                </div>
                <div class="mb-3">
                    <label class="form-label required">集合时间</label>
                    <div class="input-group datetime" id="collectionTime">
                        <input type="text" class="form-control" name="collectionTimeRange" placeholder="选择时间范围">
                        <span class="input-group-text"><i class="fa fa-clock"></i></span>
                    </div>
                </div>
                <div class="mb-3">
                    <label class="form-label required">可预订份数</label>
                    <input type="number" class="form-control" name="bookableQuantity" min="1" value="1">
                </div>
            </div>
        </div>
    </div>
  </div>

    <!-- 订单规则面板 -->
    <div class="col-12 col-xl-6 mb-4">
  <div class="card shadow-sm h-100">
    <div class="card-header py-3 bg-light">
        <div class="card-header d-flex justify-content-between align-items-center">
            <h5 class="mb-0 required">订单规则配置</h5>
            
        </div>
        <div>
            <div class="card-body">
                <div class="mb-3">
                    <label class="form-label required">取消类型</label>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="cancelType" id="cancelAny" value="any">
                        <label class="form-check-label" for="cancelAny">随时退</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="cancelType" id="cancelRule" value="rule" checked>
                        <label class="form-check-label" for="cancelRule">按规则退</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="cancelType" id="cancelNo" value="no">
                        <label class="form-check-label" for="cancelNo">不可退</label>
                    </div>
                </div>
                <div class="mb-3">
    <label class="form-label required">确认方式</label>
    <div class="form-check">
        <input class="form-check-input" type="radio" name="confirmType" id="confirmImmediate" value="immediate">
        <label class="form-check-label">及时确认</label>
    </div>
    <div class="form-check">
        <input class="form-check-input" type="radio" name="confirmType" id="confirmSecondary" value="secondary" checked>
        <label class="form-check-label">二次确认</label>
      </div>
</div>
<div class="mb-3">
    <label class="form-label required">订单支付确认时长</label>
    <select class="form-select" name="paymentConfirmDuration">
        <option value="30">30分钟</option>
        <option value="60" selected>60分钟</option>
        <option value="120">120分钟</option>
    </select>
</div>
<div class="mb-3">
    <label class="form-label required">订单确认方式</label>
    <div class="form-check">
        <input class="form-check-input" type="radio" name="orderConfirmMethod" id="confirmWorkday" value="workday" checked>
        <label class="form-check-label">工作日确认</label>
    </div>
    <div class="form-check">
        <input class="form-check-input" type="radio" name="orderConfirmMethod" id="confirmAnytime" value="anytime">
        <label class="form-check-label">任意时间确认</label>
    </div>
</div>
<div class="mb-3">
    <label class="form-label required">是否支持部分退</label>
    <div class="form-check">
        <input class="form-check-input" type="radio" name="partialRefund" id="refundYes" value="yes">
        <label class="form-check-label">是</label>
    </div>
    <div class="form-check">
        <input class="form-check-input" type="radio" name="partialRefund" id="refundNo" value="no" checked>
        <label class="form-check-label">否</label>
    </div>
</div>
            </div>
        </div>
    </div>

        <!-- 客户信息面板 -->
    <div class="card form-section">
        <div class="card-header d-flex justify-content-between align-items-center">
            <h5 class="mb-0 required">客户信息配置</h5>
            <i class="collapse-icon"></i>
        </div>
        <div>
            <div class="card-body">
                <div class="mb-3">
                    <label class="form-label required">联系人信息</label>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" name="contactInfo" id="phone" checked required>
                        <label class="form-check-label">手机号(必填)</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" name="contactInfo" id="email" checked>
                        <label class="form-check-label">邮箱(预填)</label>
                    </div>
                </div>
                <div class="mb-3">
    <label class="form-label required">支持手机号格式</label>
    <div class="form-check">
        <input class="form-check-input" type="radio" name="phoneFormat" id="allPhones" checked>
        <label class="form-check-label">支持所有手机号</label>
    </div>
    <div class="form-check">
        <input class="form-check-input" type="radio" name="phoneFormat" id="cnPhones">
        <label class="form-check-label">仅支持中国大陆手机号</label>
    </div>
</div>
<div class="mb-3">
    <label class="form-label required">是否需要游客信息</label>
    <div class="form-check">
        <input class="form-check-input" type="radio" name="guestInfoNeed" id="noGuest" checked>
        <label class="form-check-label">无需游客信息</label>
    </div>
    <div class="form-check">
        <input class="form-check-input" type="radio" name="guestInfoNeed" id="yesGuest">
        <label class="form-check-label">需要游客信息</label>
    </div>
    <div class="guest-info-fields mt-2" style="display: none;">
        <label class="form-label required">游客信息</label>
        <div class="form-check">
            <input class="form-check-input" type="checkbox" name="guestInfo" id="chineseName">
            <label class="form-check-label">中文姓名</label>
        </div>
        <div class="form-check">
            <input class="form-check-input" type="checkbox" name="guestInfo" id="englishName">
            <label class="form-check-label">英文姓名</label>
        </div>
        <div class="form-check">
    <input class="form-check-input" type="checkbox" name="guestInfo" id="idCard">
    <label class="form-check-label">身份证</label>
</div>
<div class="form-check">
    <input class="form-check-input" type="checkbox" name="guestInfo" id="passport">
    <label class="form-check-label">护照</label>
</div>
<div class="form-check">
    <input class="form-check-input" type="checkbox" name="guestInfo" id="studentCard">
    <label class="form-check-label">学生证</label>
</div>
<div class="form-check">
    <input class="form-check-input" type="checkbox" name="guestInfo" id="militaryCard">
    <label class="form-check-label">军官证</label>
</div>
<div class="form-check">
    <input class="form-check-input" type="checkbox" name="guestInfo" id="returnPermit">
    <label class="form-check-label">回乡证</label>
</div>
<div class="form-check">
    <input class="form-check-input" type="checkbox" name="guestInfo" id="taiwanPermit">
    <label class="form-check-label">台胞证</label>
</div>
<div class="form-check">
    <input class="form-check-input" type="checkbox" name="guestInfo" id="hkMacauPermit">
    <label class="form-check-label">港澳通行证</label>
</div>
<div class="form-check">
    <input class="form-check-input" type="checkbox" name="guestInfo" id="permanentResidence">
    <label class="form-check-label">外国人永久居留证</label>
</div>
    </div>
</div>
            </div>
        </div>
    </div>

    <!-- 产品内容面板 -->
    <div class="card form-section">
        <div class="card-header d-flex justify-content-between align-items-center">
            <h5 class="mb-0 required">产品内容配置</h5>
            <i class="collapse-icon"></i>
        </div>
        <div>
            <div class="card-body">
                <div class="mb-3 triple-textarea">
                    <div>
                        <label class="form-label required">费用包含</label>
                        <textarea class="form-control" name="costInclude" rows="3"></textarea>
                    </div>
                    <div>
                        <label class="form-label required">费用不含</label>
                        <textarea class="form-control" name="costExclude" rows="3"></textarea>
                    </div>
                    <div>
                        <label class="form-label">费用补充</label>
                        <textarea class="form-control" name="costNote" rows="3"></textarea>
                    </div>
                </div>
                <div class="mb-3">
    <label class="form-label required">商品图片</label>
    <input type="file" class="form-control" name="productImages" multiple accept="image/*">
    <div class="image-preview"></div>
</div>
<div class="mb-3">
    <label class="form-label required">商品视频</label>
    <input type="file" class="form-control" name="productVideos" accept="video/*">
</div>
            </div>
        </div>
    </div>

    <!-- 库存销售面板 -->
    <div class="card form-section">
        <div class="card-header d-flex justify-content-between align-items-center">
            <h5 class="mb-0 required">库存销售配置</h5>
            <i class="collapse-icon"></i>
        </div>
        <div>
            <div class="card-body">
                <div class="mb-3">
                    <label class="form-label required">库存扣减方式</label>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="stockDeduct" id="deductOnOrder" checked>
                        <label class="form-check-label">拍下减库存</label>
                    </div>
                    <div class="mb-3">
    <label class="form-label required">库存数量</label>
    <input type="number" class="form-control" name="stockQuantity" min="0" value="100">
</div>
<div class="mb-3">
    <label class="form-label required">单日价格</label>
    <input type="number" class="form-control" name="dailyPrice" min="0" step="0.01" value="99.99">
</div>
                </div>
            </div>
        </div>
    </div>

    <!-- 时间设置面板 -->
    <div class="card form-section">
        <div class="card-header d-flex justify-content-between align-items-center">
            <h5 class="mb-0 required">时间设置配置</h5>
            <i class="collapse-icon"></i>
        </div>
        <div>
            <div class="card-body">
                <div class="mb-3">
                    <label class="form-label required">上架时间段</label>
                    <div class="input-group date" id="saleDateRange">
                        <input type="text" class="form-control" name="saleDateRange" placeholder="选择日期范围">
                        <span class="input-group-text"><i class="fa fa-calendar"></i></span>
                    </div>
                </div>
                <div class="mb-3">
                    <label class="form-label required">服务时间外</label>
                    <div class="input-group datetime" id="offServiceTime">
                        <input type="text" class="form-control" name="offServiceTime" placeholder="选择服务时间外">
                        <span class="input-group-text"><i class="fa fa-clock"></i></span>
                    </div>
                </div>
                <div class="mb-3">
                    <label class="form-label required">有服务时间</label>
                    <div class="input-group datetime" id="onServiceTime">
                        <input type="text" class="form-control" name="onServiceTimeRange" placeholder="选择服务时间范围">
                        <span class="input-group-text"><i class="fa fa-clock"></i></span>
                    </div>
                </div>
                <div class="mb-3">
                    <label class="form-label required">使用时限</label>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="validityPeriod" id="validToday" value="today" checked>
                        <label class="form-check-label">当日有效</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="validityPeriod" id="validSpecific" value="specific">
                        <label class="form-check-label">指定日期</label>
                    </div>
                </div>
                <div class="mb-3">
                    <label class="form-label required">使用日期</label>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="useDate" id="dateNeed" value="need" checked>
                        <label class="form-check-label">需指定</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="useDate" id="dateNone" value="none">
                        <label class="form-check-label">无需指定</label>
                    </div>
                </div>
                    <div class="input-group date" id="saleDateRange">
                        <input type="text" class="form-control" name="saleDateRange" placeholder="选择日期范围">
                        <span class="input-group-text"><i class="fa fa-calendar"></i></span>
                    </div>
                </div>
                <div class="mb-3">
    <label class="form-label required">是否有服务时间限制</label>
    <div class="form-check">
        <input class="form-check-input" type="radio" name="serviceTimeLimit" id="timeLimitYes">
        <label class="form-check-label">是</label>
    </div>
    <div class="form-check">
        <input class="form-check-input" type="radio" name="serviceTimeLimit" id="timeLimitNo" checked>
        <label class="form-check-label">否</label>
    </div>
</div>
            </div>
        </div>
    </div>

    <!-- 凭证核销面板 -->
    <div class="card form-section">
        <div class="card-header d-flex justify-content-between align-items-center">
            <h5 class="mb-0 required">凭证核销配置</h5>
            <i class="collapse-icon"></i>
        </div>
        <div>
            <div class="card-body">
                <div class="mb-3">
                <label class="form-label required">兑换凭证</label>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="voucherType" id="eVoucher" checked>
                    <label class="form-check-label">电子凭证</label>
                </div>
            </div>
            <div class="mb-3">
                <label class="form-label required">取票地址</label>
                <input type="text" class="form-control" name="pickupAddress" placeholder="请输入取票地址">
            </div>
            <div class="mb-3">
                <label class="form-label required">取票方式</label>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="pickupMethod" id="pickupScenic" value="scenic" checked>
                    <label class="form-check-label">景区取</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="pickupMethod" id="pickupNonScenic" value="nonScenic">
                    <label class="form-check-label">非景区取</label>
                </div>
            </div>
            <div class="mb-3">
                <label class="form-label required">取票时间</label>
                <div class="input-group datetime" id="pickupTime">
                    <input type="text" class="form-control" name="pickupTimeRange" placeholder="选择取票时间范围">
                    <span class="input-group-text"><i class="fa fa-clock"></i></span>
                </div>
            </div>
            <div class="mb-3">
                <label class="form-label required">核销方式</label>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="verifyMethod" id="verifyAuto" value="auto" checked>
                    <label class="form-check-label">到期自动核销</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="verifyMethod" id="verifyManual" value="manual">
                    <label class="form-check-label">期内核销</label>
                </div>
            </div>
                    <div class="mb-3">
    <label class="form-label required">凭证上传</label>
    <div class="form-check">
        <input class="form-check-input" type="radio" name="voucherUpload" id="uploadYes" checked>
        <label class="form-check-label">是</label>
    </div>
    <div class="form-check">
        <input class="form-check-input" type="radio" name="voucherUpload" id="uploadNo">
        <label class="form-check-label">否</label>
    </div>
</div>
<div class="mb-3">
    <label class="form-label required">是否多次核销</label>
    <div class="form-check">
        <input class="form-check-input" type="radio" name="multiVerify" id="verifyYes">
        <label class="form-check-label">是</label>
    </div>
    <div class="form-check">
        <input class="form-check-input" type="radio" name="multiVerify" id="verifyNo" checked>
        <label class="form-check-label">否</label>
    </div>
</div>
                </div>
            </div>
        </div>
    </div>

    <div class="fixed-bottom bg-white p-3 border-top">
  <div class="container">
    <button class="btn btn-primary px-4 rounded-pill w-100" type="submit">
      <i class="fas fa-save me-2"></i>保存配置
    </button>
  </div>
</div>

<script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/bootstrap/5.1.3/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/bootstrap-datetimepicker/4.17.47/js/bootstrap-datetimepicker.min.js"></script>
<script>
    // 初始化所有时间选择器
    $('.datetime').datetimepicker({ format: 'HH:mm', useCurrent: false });
    $('.date').datetimepicker({ format: 'YYYY-MM-DD', useCurrent: false });

    // 表单验证
// 邮箱验证正则
const emailRegex = /^[\w.-]+@[\w.-]+\.[a-zA-Z]{2,}$/;
// 手机号验证正则（支持中国大陆）
const phoneRegex = /^1[3-9]\d{9}$/;

// 游客信息显示控制
$('input[name="guestInfoNeed"]').on('change', function() {
    $('.guest-info-fields').toggle(this.id === 'yesGuest');
});

// 完整验证逻辑
    $('form').on('submit', function(e) {
        e.preventDefault();
        let isValid = true;

        // 数字字段验证
$('input[type="number"]').each(function() {
    if (this.value < 0) {
        alert('数字字段不能为负数');
        isValid = false;
    }
});

// 邮箱格式验证
$('input[name="email"]').each(function() {
    if (this.checked && !emailRegex.test($(this).val())) {
        alert('请输入有效的邮箱地址');
        isValid = false;
    }
});

// 手机号格式验证
$('input[name="phone"]').each(function() {
    if (this.checked && !phoneRegex.test($(this).val())) {
        alert('请输入有效的中国大陆手机号');
        isValid = false;
    }
})
        $('input[type="number"]').each(function() {
            if (this.value < 0) {
                alert('数字字段不能为负数');
                isValid = false;
            }
        });

        // 时间范围验证（结束时间>开始时间）
$('#collectionTime, #onServiceTime, #pickupTime').each(function() {
    const startInput = $(this).find('input');
    startInput.on('dp.change', function(e) {
        const endTime = moment(e.date).add(1, 'hours');
        $(this).data('DateTimePicker').maxDate(endTime);
    });
});
// 时间范围验证
        $('#collectionTime input').each(function() {
            if (!moment(this.value, 'HH:mm', true).isValid()) {
                alert('请选择有效的时间');
                isValid = false;
            }
        });

        if (isValid) this.submit();
    });

    // 图片上传预览（补充之前的脚本）
    $('input[type="file"]').on('change', function(e) {
        const preview = $(this).siblings('.image-preview');
        preview.empty();
        Array.from(e.target.files).forEach(file => {
            if (file.type.startsWith('image/')) {
                const img = document.createElement('img');
                img.src = URL.createObjectURL(file);
                preview.append(img);
            }
        });
    });
    // 初始化时间选择器
    $('#collectionTime').datetimepicker({ format: 'HH:mm', useCurrent: false });

    // 图片上传预览
    $('input[type="file"]').on('change', function(e) {
        const preview = $(this).siblings('.image-preview');
        preview.empty();
        Array.from(e.target.files).forEach(file => {
            if (file.type.startsWith('image/')) {
                const img = document.createElement('img');
                img.src = URL.createObjectURL(file);
                preview.append(img);
            }
        });
    });
</script>
</body>
</html>